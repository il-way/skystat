package com.ilway.skystat.framework.parser;

import com.ilway.skystat.framework.parser.metar.entry.RemarkRegexParser;
import com.ilway.skystat.framework.parser.shared.ReportParser;
import org.junit.jupiter.api.Test;

import java.util.ArrayList;
import java.util.List;

import static org.junit.jupiter.api.Assertions.*;

public class RemarkTest {

	ReportParser<String> parser = new RemarkRegexParser();

	@Test
	public void 리마크가_존재하는_메타의_파싱에_성공해야한다() {
		String rawText = "KSFO 030953Z 29008KT 10SM FEW025 SCT250 18/12 A2995 RMK AO2 SLP142 T01780122=";

		String actual = parser.parse(rawText);
		String expected = "AO2 SLP142 T01780122=";

		assertEquals(expected, actual);
	}

	@Test
	public void 리마크가_존재하지_않는_메타는_공백문자열이_파싱된다() {
		String rawText = "KSFO 030953Z 29008KT 10SM FEW025 SCT250 18/12 A2995";

		String actual = parser.parse(rawText);
		String expected = "";

		assertEquals(expected, actual);
	}

	@Test
	void bulkTest() {
		List<String> list = List.of(
			"KJFK 221251Z 16005KT 10SM BKN100 BKN230 27/23 A2988 RMK AO2 SLP116 ACC NE-E T02670233",
			"KJFK 221351Z 14008KT 10SM FEW027 FEW050 BKN100 BKN250 27/22 A2986 RMK AO2 SLP111 T02720222",
			"KJFK 221451Z 16010KT 10SM FEW030 SCT100 BKN200 29/22 A2985 RMK AO2 SLP109 T02940222 58003",
			"KJFK 221551Z 13009KT 10SM FEW035 FEW100 SCT170 BKN250 30/22 A2983 RMK AO2 SLP102 T03000217",
			"KJFK 221651Z 12008KT 10SM FEW042 FEW100 SCT170 SCT250 30/23 A2981 RMK AO2 SLP096 T03000228",
			"KJFK 221751Z 12013KT 10SM FEW045 FEW140 SCT250 29/24 A2979 RMK AO2 SLP088 T02940239 10306 20267 58021",
			"KJFK 221851Z 13012KT 10SM FEW020 FEW045 FEW140 SCT250 29/24 A2977 RMK AO2 SLP080 CB DSNT W T02940244",
			"KJFK 221951Z 15009KT 10SM SCT045 SCT140 SCT250 29/25 A2975 RMK AO2 LTG DSNT W SLP073 CB DSNT W-NW T02890250",
			"KJFK 222051Z 15012KT 10SM SCT045 SCT140 SCT250 30/26 A2971 RMK AO2 LTG DSNT ALQDS SLP059 CB DSNT SW TCU DSNT SW-NW T03000256 58029",
			"KJFK 222146Z 16016G22KT 10SM TS BKN045CB BKN085 BKN130 BKN250 28/26 A2967 RMK AO2 LTG DSNT W-N TSB40 PRESFR OCNL LTGCG NW TS NW MOV NE CB E-SE MOV NE VCSH NW",
			"KJFK 222151Z 16012G22KT 10SM TS BKN045CB BKN085 BKN130 BKN250 28/26 A2966 RMK AO2 LTG DSNT W-N TSB40 PRESFR SLP045 OCNL LTGCG NW TS NW MOV NE CB E-SE MOV NE VCSH NW T02830256",
			"KJFK 222217Z 01011G21KT 10SM TS FEW015 BKN045 BKN060 27/24 A2968 RMK AO2 PK WND 17026/2201 WSHFT 2203 LTG DSNT ALQDS TSE2155B2156 T02670244",
			"KJFK 222244Z 01016KT 7SM R04R/4000VP6000FT -TSRA BKN017 BKN024 OVC043CB 24/23 A2970 RMK AO2 PK WND 17026/2201 WSHFT 2203 LTG DSNT ALQDS RAB31 TSE2155B2156 FRQ LTGICCG W TS W MOV NE CB E MOV NE P0006 T02390233 $",
			"KJFK 222251Z 35021G26KT 4SM -TSRA BR BKN017 BKN024 OVC043CB 24/24 A2969 RMK AO2 PK WND 36026/2248 WSHFT 2203 LTG DSNT ALQDS RAB31 TSE2155B2156 SLP053 FRQ LTGICCG W TS W MOV NE CB E MOV NE P0006 T02390239 $",
			"KJFK 222256Z 35021KT 1/2SM R04R/1800VP6000FT +TSRA BR FEW011 BKN021 OVC043CB 24/24 A2969 RMK AO2 SFC VIS 1 1/2 LTG DSNT ALQDS FRQ LTGICCCCG OHD AND ALQDS TS OHD AND ALQDS MOV NE P0000 T02390239 $",
			"KJFK 222330Z 33015KT 3SM TSRA BR SCT008 BKN015 BKN033CB OVC140 23/23 A2975 RMK AO2 SFC VIS 6 LTG DSNT ALQDS FRQ LTGIC N-NE TS N-NE MOV NE P0149 T02330233 $",
			"KJFK 222348Z 32007KT 10SM -TSRA FEW008 SCT019 BKN045CB OVC140 23/23 A2976 RMK AO2 LTG DSNT NE-SE TSE35B36 OCNL LTGICCC NW-NE TS NW-NE MOV NE P0149 $",
			"KJFK 222351Z 32007KT 10SM -TSRA FEW008 SCT019 BKN045CB OVC140 23/23 A2976 RMK AO2 LTG DSNT NE AND E TSE35B36 SLP078 OCNL LTGICCC NW-NE TS NW-NE MOV NE P0149 60155 T02330233 10300 20228 53032 $",
			"KJFK 230010Z 28006KT 10SM -RA FEW012 SCT060 BKN075 BKN140 OVC200 24/23 A2976 RMK AO2 LTG DSNT N AND NE AND SW TSE09 P0001 T02390233 $",
			"KJFK 230047Z 31005KT 10SM -TSRA FEW012 SCT055CB SCT110 BKN150 OVC200 24/23 A2975 RMK AO2 LTG DSNT SE-SW RAE14B40 TSE09B47 FRQ LTGICCC S-SW TS S-SW MOV NE OCNL LTGIC DSNT SE P0001 $",
			"KJFK 230051Z 30004KT 10SM -TSRA FEW012 SCT055CB SCT110 BKN150 OVC200 24/23 A2975 RMK AO2 LTG DSNT SE-SW RAE14B40 TSE09B47 SLP075 FRQ LTGICCC S-SW TS S-SW MOV NE OCNL LTGIC DSNT SE P0001 T02390233 $",
			"KJFK 230129Z 21007KT 10SM -RA FEW011 SCT075 BKN100 OVC140 23/23 A2976 RMK AO2 LTG DSNT E TSE28 P0001 T02330233 $",
			"KJFK 230151Z 22005KT 10SM FEW012 SCT046 BKN120 BKN140 OVC200 23/23 A2977 RMK AO2 RAE45 TSE28 SLP079 P0002 T02330233 $",
			"KJFK 230235Z 20007KT 10SM SCT009 SCT130 BKN250 23/23 A2977 RMK AO2 T02330233 $",
			"KJFK 230251Z 21006KT 10SM SCT009 SCT130 BKN250 24/24 A2977 RMK AO2 SLP080 60003 T02390239 53001 $",
			"KJFK 230347Z 23009KT 10SM BKN011 BKN075 OVC140 24/24 A2978 RMK AO2 $",
			"KJFK 230351Z 23011KT 10SM -RA BKN011 BKN075 OVC140 24/24 A2978 RMK AO2 RAB50 SLP083 P0000 T02390239 $",
			"KJFK 230442Z 25008KT 10SM SCT012 OVC160 23/23 A2976 RMK AO2 RAE37 P0001 T02330233 $",
			"KJFK 230451Z 23007KT 10SM SCT012 OVC160 23/23 A2976 RMK AO2 RAE37 SLP077 P0001 T02330233 403060228 $",
			"KJFK 230522Z 21007KT 10SM BKN009 BKN050 OVC240 23/23 A2975 RMK AO2 T02330233 $",
			"KJFK 230547Z 24008KT 10SM SCT008 BKN046 OVC220 24/24 A2976 RMK AO2 $",
			"KJFK 230551Z 24008KT 10SM SCT008 BKN046 OVC220 24/24 A2976 RMK AO2 SLP076 60004 T02390239 10239 20233 58003 $",
			"KJFK 230651Z 23007KT 10SM SCT008 BKN043 OVC170 23/23 A2974 RMK AO2 RAB19E50 SLP071 OCNL LTGIC DSNT SE CB DSNT SE P0000 T02330233 $",
			"KJFK 230751Z 19007KT 10SM -RA SCT008 OVC037 23/23 A2975 RMK AO2 RAB27 SLP074 P0000 T02330233 $",
			"KJFK 230851Z 04004KT 10SM SCT008 SCT034 OVC130 23/23 A2970 RMK AO2 RAE48 SLP056 P0000 60000 T02330233 58021 $",
			"KJFK 230936Z 35011KT 10SM -RA BKN007 OVC035 21/21 A2972 RMK AO2 RAB19 P0000 T02110211 $",
			"KJFK 230951Z 01008KT 10SM OVC007 21/21 A2972 RMK AO2 RAB19E41 SLP064 P0000 T02110211 $",
			"KJFK 231022Z 02013KT 2 1/2SM R04R/3500VP6000FT +RA BR BKN006 OVC032 21/21 A2972 RMK AO2 RAB02 P0007 T02060206 $",
			"KJFK 231041Z 36014KT 1SM R04R/2600V5000FT +RA BR SCT000 BKN006 OVC019 20/20 A2973 RMK AO2 SFC VIS 1 1/2 RAB02 RA SCT000 P0037 T02000200 $",
			"KJFK 231051Z 36011KT 1SM R04R/1600V2800FT +RA BR SCT000 BKN006 OVC014 20/20 A2972 RMK AO2 RAB02 SLP065 RA SCT000 P0074 T02000200 $",
			"KJFK 231128Z 01009KT 2 1/2SM R04R/2800VP6000FT +RA BR BKN006 BKN016 OVC037 19/19 A2974 RMK AO2 BKN006 V SCT P0113 T01940194 $",
			"KJFK 231144Z 36013KT 5SM +RA BR SCT008 BKN024 OVC047 19/19 A2974 RMK AO2 P0121 T01940194 $",
			"KJFK 231151Z 01009KT 9SM -RA SCT008 BKN024 OVC055 19/19 A2974 RMK AO2 SLP070 P0123 60197 70356 T01940194 10239 20194 51014 $",
			"KJFK 231216Z 36012KT 10SM -RA BKN009 OVC070 19/19 A2976 RMK AO2 P0001 T01940194 $",
			"KJFK 231251Z 35014KT 10SM BKN010 BKN075 20/19 A2977 RMK AO2 RAE20 SLP082 CIG 008V012 P0001 T02000194 $",
			"KJFK 231351Z 33012KT 10SM BKN012 BKN043 OVC070 21/19 A2981 RMK AO2 SLP094 T02060194",
			"KJFK 231451Z 36012KT 10SM BKN018 BKN024 OVC075 22/19 A2982 RMK AO2 SLP099 60001 T02170189 51029",
			"KJFK 231551Z 36013KT 10SM BKN020 BKN047 OVC075 23/18 A2984 RMK AO2 RAB33E45 SLP104 P0000 T02280183",
			"KJFK 231651Z 02011KT 10SM BKN023 BKN080 OVC150 23/18 A2983 RMK AO2 SLP100 T02330183",
			"KJFK 231751Z 02008KT 10SM BKN027 OVC150 24/19 A2986 RMK AO2 SLP110 60001 T02390189 10239 20194 53012",
			"KJFK 231846Z 05007KT 10SM BKN032 OVC110 24/18 A2988 RMK AO2",
			"KJFK 231851Z 04005KT 10SM BKN032 OVC110 24/18 A2988 RMK AO2 SLP119 T02440183",
			"KJFK 231937Z 00000KT 10SM BKN029 OVC042 23/18 A2988 RMK AO2 T02330183",
			"KJFK 231951Z 07005KT 10SM BKN029 OVC042 24/18 A2988 RMK AO2 SLP118 T02390183",
			"KJFK 232048Z 16006KT 10SM SCT027 OVC035 22/19 A2989 RMK AO2",
			"KJFK 232051Z 15005KT 10SM SCT027 OVC035 22/19 A2989 RMK AO2 SLP121 T02220189 53002",
			"KJFK 232151Z VRB04KT 10SM -RA SCT021 BKN030 OVC036 22/19 A2989 RMK AO2 RAB12E22B48 SLP121 P0000 T02220194",
			"KJFK 232249Z 00000KT 10SM BKN025 OVC034 22/19 A2990 RMK AO2 RAE41 P0000",
			"KJFK 232251Z 05003KT 10SM BKN025 OVC034 22/19 A2990 RMK AO2 RAE41 SLP125 P0000 T02220189",
			"KJFK 232351Z 05007KT 10SM FEW015 OVC023 22/20 A2991 RMK AO2 SLP128 VCSH E 60000 T02170200 10244 20217 51007",
			"KJFK 240051Z 06007KT 7SM -RA BKN017 OVC024 21/20 A2992 RMK AO2 RAB2359 SLP131 P0001 T02060200",
			"KJFK 240151Z 10005KT 10SM -RA FEW012 FEW024 OVC050 21/21 A2992 RMK AO2 SLP132 P0006 T02060206",
			"KJFK 240251Z 08006KT 10SM SCT012 OVC050 20/20 A2989 RMK AO2 RAE42 SLP121 P0002 60009 T02000200 58006",
			"KJFK 240351Z 07004KT 10SM SCT011 OVC050 20/20 A2990 RMK AO2 SLP124 T02000200",
			"KJFK 240451Z 06004KT 9SM -RA FEW011 OVC065 21/21 A2990 RMK AO2 RAB44 SLP124 P0000 T02060206 402440194",
			"KJFK 240551Z 02006KT 10SM FEW011 OVC070 20/20 A2988 RMK AO2 RAE17 SLP119 P0000 60009 T02000200 10217 20200 58002",
			"KJFK 240651Z 36007KT 10SM FEW011 OVC075 20/19 A2988 RMK AO2 SLP117 T02000194",
			"KJFK 240751Z 05003KT 10SM FEW013 OVC080 20/19 A2989 RMK AO2 SLP121 T02000189",
			"KJFK 240851Z 05003KT 10SM FEW012 BKN130 19/19 A2990 RMK AO2 RAB14E24 SLP126 P0000 60000 T01940189 53007",
			"KJFK 240951Z 04003KT 10SM FEW012 BKN130 BKN250 19/19 A2992 RMK AO2 SLP130 T01890189",
			"KJFK 241051Z 00000KT 10SM FEW012 SCT130 BKN250 19/19 A2993 RMK AO2 SLP134 T01940194",
			"KJFK 241151Z 03005KT 10SM FEW014 SCT130 BKN250 22/21 A2994 RMK AO2 SLP138 60000 70010 T02170206 10217 20183 51012",
			"KJFK 241251Z 03008KT 10SM FEW019 FEW130 BKN250 23/19 A2994 RMK AO2 SLP139 T02330189",
			"KJFK 241351Z 01008KT 10SM FEW023 FEW130 BKN250 25/18 A2994 RMK AO2 SLP140 T02500178",
			"KJFK 241451Z 02009KT 10SM FEW036 SCT130 SCT250 26/17 A2994 RMK AO2 SLP139 T02560172 51002",
			"KJFK 241551Z 04009KT 010V080 10SM SCT040 SCT130 SCT250 26/17 A2994 RMK AO2 SLP140 T02610167",
			"KJFK 241651Z 05010KT 10SM SCT047 BKN250 28/17 A2994 RMK AO2 SLP140 T02780172",
			"KJFK 241751Z 36008KT 10SM SCT049 BKN250 28/17 A2994 RMK AO2 SLP137 T02830167 10283 20217 58002",
			"KJFK 241851Z 35006KT 10SM SCT050 BKN250 28/16 A2994 RMK AO2 SLP137 T02830161",
			"KJFK 241951Z 19012KT 10SM SCT055 BKN090 BKN250 26/18 A2993 RMK AO2 SLP135 T02610183",
			"KJFK 242051Z 20010KT 10SM SCT055 SCT100 SCT250 26/18 A2995 RMK AO2 SLP140 T02560178 53003",
			"KJFK 242151Z 18008KT 10SM SCT055 SCT100 SCT250 26/18 A2995 RMK AO2 SLP141 T02610183",
			"KJFK 242251Z 18008KT 10SM FEW055 FEW100 SCT250 25/19 A2996 RMK AO2 SLP144 T02500194",
			"KJFK 242351Z 17006KT 10SM FEW055 FEW100 SCT250 24/19 A2998 RMK AO2 SLP151 T02390194 10289 20239 53011",
			"KJFK 250051Z 19005KT 10SM FEW055 FEW100 SCT250 23/20 A2999 RMK AO2 SLP156 T02280200",
			"KJFK 250151Z 19003KT 10SM FEW100 SCT250 22/20 A3001 RMK AO2 SLP163 T02220200",
			"KJFK 250251Z 22005KT 10SM FEW060 SCT250 22/20 A3003 RMK AO2 SLP167 T02220200 51016",
			"KJFK 250351Z 21006KT 10SM FEW060 FEW250 22/20 A3002 RMK AO2 SLP167 T02220200",
			"KJFK 250451Z 24007KT 10SM FEW060 SCT250 22/19 A3003 RMK AO2 SLP168 T02170194 402890183",
			"KJFK 250551Z 27007KT 10SM FEW060 SCT250 23/19 A3003 RMK AO2 SLP168 T02280194 10239 20217 50001",
			"KJFK 250651Z 28005KT 10SM FEW060 SCT250 22/19 A3002 RMK AO2 SLP167 T02220189",
			"KJFK 250751Z 32005KT 10SM FEW060 SCT250 22/19 A3003 RMK AO2 SLP169 T02170189",
			"KJFK 250851Z 00000KT 10SM FEW080 SCT250 20/18 A3004 RMK AO2 SLP172 T02000178 53005",
			"KJFK 250951Z 00000KT 10SM SCT100 SCT250 20/18 A3005 RMK AO2 SLP176 T02000178",
			"KJFK 251051Z 01006KT 10SM BKN110 BKN250 22/18 A3007 RMK AO2 SLP183 T02220178",
			"KJFK 251151Z 36007KT 10SM BKN120 BKN250 23/16 A3009 RMK AO2 SLP189 T02330161 10233 20194 53017",
			"KJFK 251251Z 01009KT 10SM FEW120 FEW250 25/17 A3010 RMK AO2 SLP193 T02500167",
			"KJFK 251351Z 03010KT 10SM FEW250 27/15 A3010 RMK AO2 SLP194 T02670150",
			"KJFK 251451Z 01008KT 10SM FEW250 28/15 A3011 RMK AO2 SLP196 T02780150 51007",
			"KJFK 251551Z VRB06KT 10SM FEW055 FEW250 28/14 A3012 RMK AO2 SLP198 T02780139",
			"KJFK 251651Z 03005KT 10SM SCT060 28/14 A3011 RMK AO2 SLP196 T02830144",
			"KJFK 251751Z 34006KT 10SM SCT065 28/14 A3010 RMK AO2 SLP193 T02830139 10294 20228 58003",
			"KJFK 251851Z 18009KT 10SM BKN060 BKN110 27/19 A3011 RMK AO2 SLP196 T02720189",
			"KJFK 252051Z 15008KT 10SM SCT075 SCT110 27/17 A3011 RMK AO2 SLP196 T02670172 50003",
			"KJFK 251951Z 18008KT 10SM BKN070 BKN100 28/16 A3011 RMK AO2 SLP197 T02830156");

		List<String> parsed = list.stream()
			                     .map(parser::parse)
			                     .toList();

		for (String p : parsed) {
			assertTrue(!p.isBlank());
		}
	}

}
